<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Drug interaction checker service to help ensure safe medication usage">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline';
        style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net;
        font-src 'self' https://cdn.jsdelivr.net;
        connect-src 'self' https://api.fda.gov https://api.openai.com https://api.anthropic.com https://api.perplexity.ai https://generativelanguage.googleapis.com;
        img-src 'self' data:;
        object-src 'none';
        frame-src 'none';
        frame-ancestors 'none';
        base-uri 'self';
        form-action 'self';
        upgrade-insecure-requests;
    ">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), payment=()">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.css" integrity="sha384-..." crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css?v=1.0">
    
    <!-- ì¸ë¼ì¸ CSS í…ŒìŠ¤íŠ¸ -->
    <style>
        /* CSS ë¡œë”© í…ŒìŠ¤íŠ¸ - ì´ ìŠ¤íƒ€ì¼ì´ ë³´ì´ë©´ CSSê°€ ì •ìƒ ë¡œë“œë¨ */
        body {
            background-color: #ffffff !important;
        }
        
        @media (prefers-color-scheme: dark) {
            body {
                background-color: #1a1a1a !important;
            }
        }
    </style>
    
    <!-- ê¸°ë³¸ íŒŒë¹„ì½˜ (ë¼ì´íŠ¸ ëª¨ë“œìš©) -->
    <link rel="icon" type="image/png" href="../logo/dark.png">
    
    <!-- ë‹¤í¬ ëª¨ë“œìš© íŒŒë¹„ì½˜ -->
    <link rel="icon" type="image/png" href="../logo/white.png" media="(prefers-color-scheme: dark)">
    <title>è–¬ç‰©ç›¸äº’ä½œç”¨ãƒã‚§ãƒƒã‚«ãƒ¼</title>
</head>
<body class="preload">
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p id="loadingText" style="margin-top: 1rem;">Processing...</p>
        </div>
    </div>

    <!-- Drug Detail Information Modal -->
    <div id="drugDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="drugDetailTitle"></h3>
                <button class="modal-close" onclick="closeDrugDetail()" aria-label="Close">Ã—</button>
            </div>
            <div class="modal-body" id="drugDetailBody"></div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="settings-modal">
        <div class="settings-content">
            <div class="settings-header">
                <h3 class="settings-title">
                    ğŸ¤– AIåˆ†æè¨­å®š
                </h3>
                <button class="modal-close" onclick="closeSettings()" aria-label="Close">Ã—</button>
            </div>
            <div class="settings-body">
                <!-- AI Service Selection -->
                <div class="form-group">
                    <label for="aiProvider" class="form-label">ğŸ¯ ä½¿ç”¨ã™ã‚‹AIã‚µãƒ¼ãƒ“ã‚¹</label>
                    <select id="aiProvider" class="form-select">
                        <option value="free">ğŸ†“ ç„¡æ–™AIã‚µãƒ¼ãƒ“ã‚¹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰</option>
                        <option value="openai">OpenAI (GPT-4o-mini)</option>
                        <option value="claude">Anthropic Claude</option>
                        <option value="perplexity">Perplexity AI</option>
                        <option value="gemini">Google Gemini</option>
                        <option value="auto">ğŸ² è‡ªå‹•é¸æŠï¼ˆåˆ©ç”¨å¯èƒ½ãªã‚‚ã®ï¼‰</option>
                    </select>
                    <div class="form-help">
                        ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç„¡æ–™AIã‚µãƒ¼ãƒ“ã‚¹ãŒæä¾›ã•ã‚Œã¾ã™ã€‚ã‚ˆã‚Šé«˜å“è³ªãªåˆ†æã«ã¯ã€å€‹äººã®APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
                    </div>
                </div>
                
                <!-- Free AI Service Information -->
                <div class="form-group ai-config" data-provider="free">
                    <div class="free-ai-info">
                        <h4>ğŸ†“ ç„¡æ–™AIã‚µãƒ¼ãƒ“ã‚¹</h4>
                        <p>ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ä»¥ä¸‹ã®ç„¡æ–™AI APIã‚’ä½¿ç”¨ã—ã¾ã™:</p>
                        <ul>
                            <li><strong>Hugging Face Inference API</strong> - ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«</li>
                            <li><strong>Ollama API</strong> - ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œãƒ¢ãƒ‡ãƒ«</li>
                            <li><strong>Groq API</strong> - é«˜é€Ÿæ¨è«–ã‚µãƒ¼ãƒ“ã‚¹</li>
                        </ul>
                        <div class="license-info">
                            <h5>ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æƒ…å ±</h5>
                            <p>ç„¡æ–™AIã‚µãƒ¼ãƒ“ã‚¹ã¯ä»¥ä¸‹ã®æ¡ä»¶ã§æä¾›ã•ã‚Œã¾ã™:</p>
                            <ul>
                                <li>1æ—¥ã®ä½¿ç”¨åˆ¶é™: 100å›</li>
                                <li>å¿œç­”æ™‚é–“åˆ¶é™: 30ç§’</li>
                                <li>å•†ç”¨åˆ©ç”¨åˆ¶é™</li>
                                <li>ãƒ‡ãƒ¼ã‚¿ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¯æš—å·åŒ–ã•ã‚Œã¦å‡¦ç†ã•ã‚Œã¾ã™</li>
                            </ul>
                        </div>
                    </div>
                </div>


                <div class="form-group ai-config" data-provider="openai">
                    <label for="openaiApiKey" class="form-label">
                        <span class="provider-icon" alt="OpenAI"> 
                        OpenAI APIã‚­ãƒ¼
                    </label>
                    <input type="password" 
                           id="openaiApiKey" 
                           class="form-input" 
                           placeholder="sk-..."
                           aria-label="OpenAI APIã‚­ãƒ¼">
                    <div class="form-help">
                        <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener" style="color: var(--primary);">
                            OpenAIã‚µã‚¤ãƒˆã‹ã‚‰APIã‚­ãƒ¼ã‚’å–å¾— â†’
                        </a>
                    </div>
                </div>

                <!-- Claude Settings -->
                <div class="form-group ai-config" data-provider="claude">
                    <label for="claudeApiKey" class="form-label">
                        Anthropic Claude APIã‚­ãƒ¼
                    </label>
                    <input type="password" 
                           id="claudeApiKey" 
                           class="form-input" 
                           placeholder="sk-ant-..."
                           aria-label="Claude APIã‚­ãƒ¼">
                    <div class="form-help">
                        <a href="https://console.anthropic.com/" target="_blank" rel="noopener" style="color: var(--primary);">
                            Anthropicã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰APIã‚­ãƒ¼ã‚’å–å¾— â†’
                        </a>
                    </div>
                </div>

                <!-- Perplexity Settings -->
                <div class="form-group ai-config" data-provider="perplexity">
                    <label for="perplexityApiKey" class="form-label">
                        Perplexity APIã‚­ãƒ¼
                    </label>
                    <input type="password" 
                           id="perplexityApiKey" 
                           class="form-input" 
                           placeholder="pplx-..."
                           aria-label="Perplexity APIã‚­ãƒ¼">
                    <div class="form-help">
                        <a href="https://www.perplexity.ai/settings/api" target="_blank" rel="noopener" style="color: var(--primary);">
                        </a>
                    </div>
                </div>

                <!-- Gemini Settings -->
                <div class="form-group ai-config" data-provider="gemini">
                    <label for="geminiApiKey" class="form-label">
                        Google Gemini APIã‚­ãƒ¼
                    </label>
                    <input type="password" 
                           id="geminiApiKey" 
                           class="form-input" 
                           placeholder="AI..."
                           aria-label="Gemini APIã‚­ãƒ¼">
                    <div class="form-help">
                        <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener" style="color: var(--primary);">
                            Google AI Studioã‹ã‚‰Gemini APIã‚­ãƒ¼ã‚’å–å¾— â†’
                        </a>
                    </div>
                </div>

                <!-- Status Display -->
                <div class="api-status">
                    <h4>ğŸ”‘ APIã‚­ãƒ¼ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h4>
                    <div class="status-grid">
                        <div class="status-item" id="openai-status">
                            <span class="status-icon">âšª</span>
                            <span>OpenAI</span>
                        </div>
                        <div class="status-item" id="claude-status">
                            <span class="status-icon">âšª</span>
                            <span>Claude</span>
                        </div>
                        <div class="status-item" id="perplexity-status">
                            <span class="status-icon">âšª</span>
                            <span>Perplexity</span>
                        </div>
                        <div class="status-item" id="gemini-status">
                            <span class="status-icon">âšª</span>
                            <span>Gemini</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="settings-actions">
                <button class="btn btn-secondary" onclick="closeSettings()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button class="btn btn-primary" onclick="saveSettings()">ä¿å­˜</button>
                <button class="btn btn-secondary" onclick="testAllAPIs()">ğŸ§ª APIãƒ†ã‚¹ãƒˆ</button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedbackModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Send Feedback</h3>
                <button class="modal-close" onclick="closeFeedbackModal()" aria-label="Close">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="feedbackForm" class="feedback-form">
                    <div class="form-group">
                        <label for="feedbackName" class="form-label">Name</label>
                        <input type="text" 
                               id="feedbackName" 
                               class="form-input" 
                               placeholder="Enter your name"
                               required
                               aria-label="Name">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackEmail" class="form-label">Email</label>
                        <input type="email" 
                               id="feedbackEmail" 
                               class="form-input" 
                               placeholder="Enter your email"
                               required
                               aria-label="Email">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackSubject" class="form-label">Subject</label>
                        <input type="text" 
                               id="feedbackSubject" 
                               class="form-input" 
                               placeholder="Enter feedback subject"
                               required
                               aria-label="Subject">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackMessage" class="form-label">Message</label>
                        <textarea id="feedbackMessage" 
                                  class="form-textarea" 
                                  placeholder="Enter your feedback"
                                  rows="5"
                                  required
                                  aria-label="Message"></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeFeedbackModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Send</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Header -->
        <header class="header scroll-fade">
            <h1>è–¬ç‰©ç›¸äº’ä½œç”¨ãƒã‚§ãƒƒã‚«ãƒ¼</h1>
            <p>å®‰å…¨ãªæœè–¬ã®ãŸã‚ã®<br>è–¬ç‰©é–“ã®ç›¸äº’ä½œç”¨ã‚’ç¢ºèª</p>
        </header>

        <!-- Drug Search Section -->
        <section class="card scroll-hidden scroll-delay-1">
            <h2 class="sr-only">Drug Search</h2>
            <div class="search-box">
                <input type="text" 
                       id="drugSearch" 
                       class="input-field" 
                       placeholder="è–¬ç‰©ã‚’æ¤œç´¢ã—ã¦ãã ã•ã„ (ä¾‹: ã‚¢ã‚¹ãƒ”ãƒªãƒ³ã€ã‚¿ã‚¤ãƒ¬ãƒãƒ¼ãƒ«)"
                       autocomplete="off"
                       aria-label="è–¬ç‰©æ¤œç´¢">

            </div>
            
            <div id="searchResults" class="search-results scroll-fade">
                <div id="searchResultsContent" class="search-results-content"></div>
            </div>
            
            <div class="recent-searches" style="margin-top: 1rem;">
                <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">æœ€è¿‘ã®æ¤œç´¢</div>
                <div id="recentSearchesList" style="display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>
            </div>
        </section>


        <!-- Drug Selection Section -->
        <section class="card scroll-hidden scroll-delay-3">
            <h2 class="sr-only">Drug Selection</h2>
            <div class="drug-select-section">
                <div class="drug-select-container">
                    <div class="input-wrapper">
                        <input type="text" 
                               id="drug1" 
                               class="input-field" 
                               placeholder="æœ€åˆã®è–¬ç‰©"
                               autocomplete="off"
                               aria-label="First Drug">
                    </div>
                </div>
                
                <div class="drug-select-container">
                    <div class="input-wrapper">
                        <input type="text" 
                               id="drug2" 
                               class="input-field" 
                               placeholder="2ç•ªç›®ã®è–¬ç‰©"
                               autocomplete="off"
                               aria-label="Second Drug">
                    </div>
                </div>
            </div>
            
            <button class="btn btn-primary btn-block" onclick="checkInteraction()">
                ç›¸äº’ä½œç”¨ã‚’ãƒã‚§ãƒƒã‚¯
            </button>
        </section>
        
        <!-- í˜ì´ì§€ ìƒë‹¨ì— ê³ ì •ëœ ë“œëŸ¬ê·¸ ê²€ìƒ‰ ê²°ê³¼ -->
        <div id="drug1List" class="drug-list">
            <div class="drug-items"></div>
        </div>
        <div id="drug2List" class="drug-list">
            <div class="drug-items"></div>
        </div>

        <!-- Result Section -->
        <section id="resultSection" class="result-section scroll-scale">
            <div id="result"></div>
        </section>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" onclick="scrollToTop()" title="Scroll to Top" aria-label="Scroll to Top">
        â†‘
    </button>

    <!-- Settings Button -->
    <button class="settings-fab" title="AI Settings" aria-label="AI Settings">
        âš™ï¸
    </button>

    <!-- Notify Message -->
    <span id="alertMessage" class="alert" role="alert"></span>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <!-- Medical Disclaimer -->
            <div class="footer-disclaimer">
                <div class="disclaimer-content">
                    <h4>âš ï¸ é‡è¦ãªåŒ»ç™‚å…è²¬äº‹é …</h4>
                    <p>
                        ã“ã®ãƒ„ãƒ¼ãƒ«ã¯æ•™è‚²ãŠã‚ˆã³æƒ…å ±æä¾›ç›®çš„ã®ã¿ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚åŒ»ç™‚ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€è¨ºæ–­ã€ã¾ãŸã¯æ²»ç™‚ã‚’ç›®çš„ã¨ã—ãŸã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
                        è–¬ç‰©ã‚„åŒ»ç™‚å‡¦ç½®ã«é–¢ã™ã‚‹æ±ºå®šã‚’è¡Œã†å‰ã«ã€å¿…ãšè³‡æ ¼ã®ã‚ã‚‹åŒ»ç™‚å°‚é–€å®¶ã«ã”ç›¸è«‡ãã ã•ã„ã€‚
                        è–¬ç‰©ç›¸äº’ä½œç”¨ã¯è¤‡é›‘ã§å€‹äººå·®ãŒã‚ã‚Šã¾ã™ã€‚
                    </p>
                </div>
            </div>

            <!-- Main Footer Content -->
            <div class="footer-content">
                <!-- About Section -->
                <div class="footer-section footer-about" style="padding-top: 2rem;">
                    <p>å®‰å…¨ãªè–¬ç‰©ä½¿ç”¨ã‚’ç¢ºä¿ã™ã‚‹ãŸã‚ã®è–¬ç‰©ç›¸äº’ä½œç”¨ãƒã‚§ãƒƒã‚¯ã®åŒ…æ‹¬çš„ãªãƒ„ãƒ¼ãƒ«ã€‚åŒ»ç™‚ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã«ã¤ã„ã¦ã¯å¸¸ã«åŒ»ç™‚å°‚é–€å®¶ã«ã”ç›¸è«‡ãã ã•ã„ã€‚</p>
                    <div class="footer-badges">
                        <span class="badge">FDAãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</span>
                        <span class="badge">AIæ­è¼‰</span>
                        <span class="badge">ç„¡æ–™ãƒ„ãƒ¼ãƒ«</span>
                    </div>
                </div>

                <!-- Similar Sites -->
                <div class="footer-section footer-links">
                    <h4>é¡ä¼¼ã‚µã‚¤ãƒˆ</h4>
                    <div class="medical-links">
                        <a href="https://biolabs.world" target="_blank" rel="noopener">biolabs.world</a>
                    </div>
                </div>

                <!-- Medical Resources -->
                <div class="footer-section footer-resources">
                    <h4>åŒ»ç™‚ãƒªã‚½ãƒ¼ã‚¹</h4>
                    <div class="medical-links">
                        <a href="https://www.fda.gov" target="_blank" rel="noopener">FDA Official</a>
                        <a href="https://www.drugs.com/drug_interactions.php" target="_blank" rel="noopener">Drugs.com</a>
                        <a href="https://www.webmd.com" target="_blank" rel="noopener">WebMD</a>
                        <a href="https://medlineplus.gov" target="_blank" rel="noopener">MedlinePlus</a>
                    </div>
                </div>

                <!-- Contact & Social -->
                <div class="footer-section footer-contact">
                    <h4>ãŠå•ã„åˆã‚ã›</h4>
                    <style>
                        h4 {
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            align-items: center;
                            text-align: center;
                            font-size: 1rem;
                            font-weight: 600;
                            margin-bottom: 0.2rem;
                        }
                        a {
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            align-items: center;
                            text-align: center;
                            font-size: 0.8rem;
                            color: var(--text-secondary);
                        }
                    </style>
                    <div class="social-links">
                        <a href="mailto:pistolinkr@icloud.com" title="Email">
                            <span>Email</span>
                        </a>
                        <a href="https://github.com/pistolinkr" target="_blank" rel="noopener" title="GitHub">
                            <span>GitHub</span>
                        </a>
                        <button class="feedback-btn" onclick="openFeedbackModal()" title="Send Feedback">
                            <span>Feedback</span>
        
                    </div>
                        </div>
                        </div>

            <!-- Footer Divider -->
            <div class="footer-divider"></div>

            <!-- Bottom Bar -->
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <div class="footer-version-language">
                        <div class="footer-version">
                            <span>Beta v4.8 | G.gearÂ® Pistolâ„¢</span>
                        </div>
                        <div class="footer-language">
                            <span class="current-language">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</span>
                        </div>
                    </div>
                    <div class="footer-legal">
                        <a href="#" onclick="showPrivacyPolicy()">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
                        <a href="#" onclick="showTermsOfService()">åˆ©ç”¨è¦ç´„</a>
                        <a href="#" onclick="showDataSources()">ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</a>
                            </div>
                    <div class="footer-copyright">
                        <p>&copy; 2025 Pistolinkr. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="../i18n.js"></script>
    <script src="config.js"></script>
    <script src="scripts.js"></script>
    
    <!-- Vercel Speed Insights -->
    <script>
        (function() {
            var script = document.createElement('script');
            script.src = 'https://vercel.com/_next/static/chunks/vercel-speed-insights-client.js';
            script.defer = true;
            document.head.appendChild(script);
        })();
    </script>
    <!-- Vercel Speed Insights -->
    <script>
        (function() {
            var script = document.createElement('script');
            script.src = 'https://vercel.com/_next/static/chunks/vercel-speed-insights-client.js';
            script.defer = true;
            document.head.appendChild(script);
        })();
    </script>
